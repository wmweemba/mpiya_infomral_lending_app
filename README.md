# Mpiya - Informal Lending Manager (PWA)

Mpiya is a production-ready, offline-first Progressive Web App (PWA) designed to manage informal money lending in Zambia. Built with modern web technologies, it allows lenders to track loans, borrowers, and payments with automatic interest calculations, overdue penalties, and cloud synchronization.

## ðŸš€ Features

*   **Localized for Zambia:** Handles Zambian Kwacha (ZMW) currency formatting and localization.
*   **Smart Loan Management:**
    *   Preset fixed tenors with simple interest (1 Week: 15%, 2 Weeks: 20%, etc.).
    *   Custom tenor options for flexible lending.
    *   Automatic Due Date calculation.
*   **Automated Penalties:** Automatically calculates a +5% penalty for every week a loan is overdue.
*   **Offline-First:** Works 100% offline using IndexedDB. Data is stored locally on the device.
*   **Cloud Sync:** Seamless integration with Google Drive and Google Sheets for data backup and export when online.
*   **Security:**
    *   Passcode protection on app start and after inactivity (Default: `7802`).
    *   Biometric-ready architecture.
*   **Reporting:** Visual dashboard, loan status filtering, and PDF/CSV export capabilities.
*   **PWA:** Installable on mobile and desktop devices with native-like experience.

## ðŸ›  Tech Stack

*   **Frontend:** React 18 (Lite), TypeScript, Vite
*   **Styling:** Tailwind CSS
*   **Storage:** IndexedDB (via `idb` library)
*   **Cloud/Auth:** Google Identity Services, Google Drive API, Google Sheets API
*   **Export:** jsPDF, jspdf-autotable

## ðŸ“‚ File Structure

```text
mpiya-pwa/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â””â”€â”€ Icons.tsx       # Reusable SVG icons
â”‚   â”œâ”€â”€ BorrowersScreen.tsx # Borrower management UI
â”‚   â”œâ”€â”€ Dashboard.tsx       # Home screen with stats
â”‚   â”œâ”€â”€ LoansScreen.tsx     # Loan list and management
â”‚   â””â”€â”€ ReportsScreen.tsx   # Analytics and export
â”œâ”€â”€ App.tsx                 # Main application entry & routing
â”œâ”€â”€ constants.ts            # Config, API keys, and business logic constants
â”œâ”€â”€ db.ts                   # IndexedDB abstraction layer
â”œâ”€â”€ googleApi.ts            # Google Drive & Sheets sync service
â”œâ”€â”€ index.html              # HTML entry point & CDN scripts
â”œâ”€â”€ index.tsx               # React DOM rendering
â”œâ”€â”€ types.ts                # TypeScript interfaces
â”œâ”€â”€ utils.ts                # Helper functions (currency, dates, calculations)
â”œâ”€â”€ manifest.json           # PWA configuration (generated by Vite)
â””â”€â”€ vite.config.ts          # Build configuration
```

## âš¡ Installation & Setup

### Prerequisites
*   Node.js (v18 or higher)
*   A Google Cloud Console project with Drive and Sheets APIs enabled.

### 1. Clone & Install
```bash
# Clone the repository (if applicable) or download source
npm install
```

### 2. Configure Environment
Open `constants.ts` and update the Google Cloud credentials:

```typescript
// constants.ts
export const GOOGLE_CLIENT_ID = 'YOUR_CLIENT_ID.apps.googleusercontent.com';
export const GOOGLE_API_KEY = 'YOUR_API_KEY';
```
*Note: Ensure `http://localhost:5173` is added to your "Authorized JavaScript origins" in Google Cloud Console.*

### 3. Run Locally
```bash
npm run dev
```
Open `http://localhost:5173` in your browser.

### 4. Build for Production
```bash
npm run build
```
The output will be in the `dist` directory, ready to be deployed to Vercel, Netlify, or any static host.

## ðŸ“– Usage Guide

### Initial Login
*   The default passcode is **7802**.
*   You can change this in `constants.ts` or implement a user settings store.

### Creating a Loan
1.  Go to the **Loans** tab.
2.  Click the **+** button.
3.  Select an existing Borrower or create a new one.
4.  Enter the Principal amount.
5.  Select a Tenor (e.g., "2 Weeks"). The interest and total due are calculated automatically.

### Cloud Sync
1.  Click the **Cloud Icon** in the header.
2.  Sign in with your Google Account.
3.  The app will create/update:
    *   `ShylockZMW_backup.json` in Google Drive (Full backup).
    *   `Shylock ZMW Loans Master` in Google Sheets (Readable spreadsheet).

## ðŸ“„ License
This project is open-source.
